<div class="jumbotron jumbotron-fluid">
  <div class="container">
    <% if !@advertisements.nil? %>
    <h1 class="display-3">Annonces disponibles</h1>
    <p class="lead">Consultez les annonces disponibles ou publiez-en une !</p>
    <% else %>
      <h1 class="display-3">Aucune annonce trouvée</h1>
      <p class="lead">Inscrivez-vous et publiez-en une !</p>
    <% end %>
    <%= link_to 'Poster une nouvelle annonce', new_advertisement_path, class: 'btn btn-primary' %>
  </div>
</div>
<div class="container" style="width:90%;" >
  <div class="row">
    <% @advertisements.each do |advertisement| %>
      <div class="card" style="margin: 10px;">
        <div class="card-block">
          <h4 class="card-title"><%= advertisement.title %></h4>
          <h6 class="card-subtitle mb-2 text-muted"><%= advertisement.created_at.strftime('Posté le %d/%m/%Y') %> par <%= advertisement.user.name %></h6>
          <p class="card-text"><%= advertisement.content %></p>
          <%= link_to "Voir l'annonce",  advertisement_path(advertisement), class: "card-link btn btn-default" %>
          <% if session[:user_id] == advertisement.user_id && session[:admin].nil? %>
            <%= link_to "Editer l'annonce", edit_advertisement_path(advertisement), class: 'btn btn-default' %>
          <% end %>
          <% if !session[:admin].nil? %>
            <%= link_to "Editer l'annonce", edit_advertisement_path(advertisement), class: 'btn btn-default' %>
            <%= link_to "Detruire l'annonce", advertisement_path(advertisement), method: :delete, data: { confirm: 'Etes-vous sur ?' }, class: 'btn btn-danger' %>
          <% end %>
          
        </div>
        <div class="card-footer text-muted" style="display: inline-block;">
          <%= pluralize(advertisement.price, "euro") %>
          <% if !session[:admin].nil? && !advertisement.published %>
            <%= form_for :advertisement, url: advertisements_path do |f| %>
              <%= f.hidden_field :title, value: advertisement.title %>
              <%= f.hidden_field :content, value: advertisement.content %>
              <%= f.hidden_field :price, value: advertisement.price %>
              <%= f.hidden_field :user_id, value: session[:user_id] %>
              <%= f.hidden_field :published, value: true %>
              <%= f.submit "Publier l'annonce", class: "btn btn-primary float-right" %>
            <% end %>
          <% end %>
        </div>
      </div>
    <% end %>
  </div>
</div>
<br>
